CREATE TABLE DOCTOR
(
    NAME VARCHAR2(20),
    SPACIALIZATION VARCHAR2(2),
    FEE NUMBER,

    CONSTRAINT DOCTOR_PK PRIMARY KEY (NAME, SPACIALIZATION)
);

CREATE TABLE PATIENT
(
    PATIENT_NO VARCHAR2(5),
    NAME VARCHAR2(20),
    ADDRESS VARCHAR2(10),

    CONSTRAINT PATIENT_PK PRIMARY KEY (PATIENT_NO)
);

CREATE TABLE APPOINTMENT
(
    PATIENT_NO VARCHAR2(5),
    NAME VARCHAR2(20),
    SPACIALIZATION VARCHAR2(2),

    CONSTRAINT APPOINTMENT_PK PRIMARY KEY (PATIENT_NO, NAME, SPACIALIZATION),
);


ALTER TABLE APPOINTMENT ADD APPOINTMENT_DATE DATE;
ALTER TABLE APPOINTMENT DROP CONSTRAINT APPOINTMENT_PK;

ALTER TABLE ADD CONSTRAINT APPOINTMENT_PK 
PRIMARY KEY (PATIENT_NO, NAME, SPACIALIZATION, APPOINTMENT_DATE);  

ALTER TABLE APPOINTMENT DROP CONSTRAINT APPOINTMENT_PK;

ALTER TABLE APPOINTMENT RENAME COLUMN PATIENT_NO TO P_NO;
ALTER TABLE APPOINTMENT RENAME COLUMN NAME TO D_NAME;

ALTER TABLE APPOINTMENT RENAME TABLE APPOINTMENT TO APPOINTMENT_INFO;

ALTER TABLE APPOINTMENT_INFO ADD CONSTRAINT APPOINTMENT_PK
PRIMARY KEY (P_NO, D_NAME, SPACIALIZATION, APPOINTMENT_DATE);

ALTER TABLE ADD CONSTRAINT FK_APPOINTMENT_P_NO FOREIGN KEY (P_NO)
REFERENCES PATIENT (PATIENT_NO) ON DELETE CASCADE;

ALTER TABLE ADD CONSTRAINT FK_APPOINTMENT_D_NAME FOREIGN KEY (D_NAME)
REFERENCES DOCTOR (NAME) ON DELETE CASCADE;


INSERT INTO DOCTOR (NAME, SPECIALIZATION, FEE)
VALUES ('MR. X', 'CS', 2000);

INSERT INTO DOCTOR (NAME, SPECIALIZATION, FEE)
VALUES ('MR. Y', 'GS', 1500);

INSERT INTO DOCTOR (NAME, SPECIALIZATION, FEE)
VALUES ('MR. Z', 'IM', 1800);



INSERT INTO PATIENT (PATIENT_NO, NAME, ADDRESS)
VALUES ('P-101', 'A', 'DHK');

INSERT INTO PATIENT (PATIENT_NO, NAME, ADDRESS)
VALUES ('P-102', 'B', 'KHL');

INSERT INTO PATIENT (PATIENT_NO, NAME, ADDRESS)
VALUES ('P-103', 'C', 'RAJ');



INSERT INTO APPOINTMENT_INFO (P_NO, D_NAME, SPECIALIZATION, APPOINTMENT_DATE)
VALUES ('P-101', 'MR. X', 'CS', TO_DATE('2023-08-25', 'YYYY-MM-DD'));

INSERT INTO APPOINTMENT_INFO (P_NO, D_NAME, SPECIALIZATION, APPOINTMENT_DATE)
VALUES ('P-102', 'MR. Y', 'GS', TO_DATE('2023-08-26', 'YYYY-MM-DD'));

INSERT INTO APPOINTMENT_INFO (P_NO, D_NAME, SPECIALIZATION, APPOINTMENT_DATE)
VALUES ('P-103', 'MR. Z', 'IM', TO_DATE('2023-08-27', 'YYYY-MM-DD'));



-- 4

-- A
-- Find all the Doctors’ names whose fees are less than 1500.
SELECT NAME FROM DOCTOR WHERE FEE < 1500;

-- B
-- Find all the Patients’ names who live in ‘KHL’ city.
SELECT NAME FROM PATIENT WHERE ADDRESS = 'KHL';

-- C
-- Show the result of Cartesian Product between PATIENT and APPOINTMENT_INFO table.
SELECT * FROM PATIENT, APPOINTMENT_INFO;

-- D
-- Show the result of Natural Join between PATIENT and APPOINTMENT_INFO table.
SELECT * FROM PATIENT NATURAL JOIN APPOINTMENT_INFO;

-- E
-- Find all the Patient’s names and their address who have an appointment today.


-- F
-- Find all the Doctor-related information who have patients from ’DHK’.


-- G
-- Find all Patient-related information who has an appointment with a doctor of ’GS’ specialization or a doctor whose fee is greater than 1500.


-- 5

-- A
-- Update the NAME and ADDRESS of a tuple from ’A’ and ’DHK ’ to ’K’ and ’RAJ’ accordingly.
UPDATE PATIENT SET NAME = 'K', ADDRESS = 'RAJ' WHERE NAME = 'A';

-- B
-- Update the NAME of table DOCTOR from ’MR. Y’ as ’Ms. Y’.
UPDATE DOCTOR SET NAME = 'Ms. Y' WHERE NAME = 'MR. Y';

-- C
-- Delete Patient with PATIENT_NO P-101.
DELETE FROM PATIENT WHERE PATIENT_NO = 'P-101';

-- D
-- Delete all the information without deleting the table structure.
DELETE FROM DOCTOR;